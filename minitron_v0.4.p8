pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init()
 poke(0x5f2d, 1)
 menus={}
 windows={}
 menushow=0
 sta=0
 buttons={}
 mwx=0
 mwy=0
end

function _update()
 for nybut in all(buttons) do
  if mybut.c==1 then
   create_window(30,40,50,50,"explorer")
  end
 end
 win_close()
 msx=stat(32)
 msy=stat(33)
 clickstrt()
 updbtn()
 if clnst==1 then
  create_window(0,60,40,59,"start")
  crtbtn(8,8,20)
 end
 if stat(34)==2 then
  menushow=1
  mx=msx
  my=msy
  mx2=msx+44
  my2=msy+18
 elseif stat(34)==1 then
  menushow=0
 end
end

function _draw()
 cls(13)
 spr(16,0,120)
 for i=1,14 do
  spr(17,i*8,120)
 end
 drwmenu()
 draw_window()
 drwbtn()
 spr(18,120,120)
 spr(1,msx,msy)
end
-->8
--ui interaction
function clickstrt()
	if stat(34)==1 then
	 if msx>=0 and msx<=8 then
	  if msy>=120 and msy<=128 then
	   clnst=1
	  end
	 end
	else
	 clnst=0
	end
end
--menus
function updmenu()

end

function drwmenu()
 if menushow==1 then
  rectfill(mx,my,mx2,my2,5)
  print("create",mx+1,my+1,7)
  print("settings",mx+1,my+7,7)
  print("personalize",mx+1,my+13,7)
 end
end
--windows
function create_window(wx,wy,ww,wh,wt)
 mywin={}
 mywin.x=wx
 mywin.y=wy
 mywin.w=ww
 mywin.h=wh
 mywin.t=wt
 add(windows,mywin)
end

function update_window()
end

function draw_window()
 for mywin in all(windows) do
  rectfill(mywin.x,mywin.y,mywin.x+mywin.w,mywin.y+mywin.h,6)
  rect(mywin.x,mywin.y,mywin.x+mywin.w,mywin.y+mywin.h,5)
  rect(mywin.x,mywin.y,mywin.x+mywin.w,mywin.y+7,5)
  print(mywin.t,mywin.x+2,mywin.y+2,0)
  spr(19,mywin.x+mywin.w-7,mywin.y)
 end
end

function del_window()
 for mywin in all(windows) do
  del(windows, mywin)
 end 
end

function win_close()
 if stat(34)==1 then
  for mywin in all(windows) do
   if msx>mywin.x+mywin.w-7 and msx<mywin.x+mywin.w then
    if msy>mywin.y and msy<mywin.y+8 then
     del_window()
    end
   end
  end
 end
end
--buttons
function crtbtn(bx,by,bs)
 mybut={}
 mybut.x=bx
 mybut.y=by
 mybut.s=bs
 mybut.c=0
 add(buttons,mybut)
end

function updbtn()
 for mywin in all(windows) do
  mwx=mywin.x
  mwy=mywin.y
	 for mybut in all(buttons) do
	  if stat(34)==1 then
	   if msx>mybut.x+mywin.x and msx<mybut.x+mywin.x+8 then
     if msy>mybut.y+mywin.y+8 and msy<mybut.y+mywin.y+16 then
    	 mybut.c=1
	    end
	   end
	  else
 	  mybut.c=0
	  end
	 end
	end
end

function drwbtn()
 for mybut in all(buttons) do
  spr(mybut.s,mybut.x+mwx,mybut.y+mwy+7)
 end
end
__gfx__
00000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000171000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700177100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000177710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000177771000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700177110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000011710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666665666666666666666600000000ddddddd50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6777777577777777777777760ddddd50d66666650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6776977577777777777777760d877850d69966650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
67d8867577777777777777760d788750d6aaaa650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
67688c7577777777777777760d788750d6aaaa650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677b677577777777777777760d877850d6aaaa650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6777777577777777777777760d555550d66666650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65555555666666666666666600000000d55555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000600000b6000b600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
